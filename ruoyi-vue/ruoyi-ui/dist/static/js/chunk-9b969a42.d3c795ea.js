(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9b969a42"],{"4a49a":function(e,t,a){},"6a97":function(e,t,a){"use strict";a("4a49a")},"8a79":function(e,t,a){"use strict";var r=a("23e7"),n=a("e330"),l=a("06cf").f,o=a("50c4"),c=a("577e"),s=a("5a34"),i=a("1d80"),u=a("ab13"),p=a("c430"),m=n("".endsWith),d=n("".slice),y=Math.min,b=u("endsWith"),h=!p&&!b&&!!function(){var e=l(String.prototype,"endsWith");return e&&!e.writable}();r({target:"String",proto:!0,forced:!h&&!b},{endsWith:function(e){var t=c(i(this));s(e);var a=arguments.length>1?arguments[1]:void 0,r=t.length,n=void 0===a?r:y(o(a),r),l=c(e);return m?m(t,l,n):d(t,n-l.length,n)===l}})},a6fc:function(e,t,a){"use strict";a.d(t,"f",(function(){return n})),a.d(t,"j",(function(){return l})),a.d(t,"d",(function(){return o})),a.d(t,"m",(function(){return c})),a.d(t,"i",(function(){return s})),a.d(t,"g",(function(){return i})),a.d(t,"l",(function(){return u})),a.d(t,"e",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"h",(function(){return d})),a.d(t,"k",(function(){return y})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return h}));a("8a79");var r=a("b775");function n(){return Object(r["a"])({url:"/api/report/getCompanySearchOptions",method:"get"})}function l(e){return Object(r["a"])({url:"/api/report/getLastestYearData",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/api/report/getCompanyReportData",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/api/report/getValidYears",method:"get",params:{includeMiddleYear:e}})}function s(e){return Object(r["a"])({url:"/api/report/getDetailLineChart",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/api/report/getDataLineChart",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/api/report/sandian",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/api/report/getCompanyReportDataWithInc",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/api/report/getCompanyDetailDataWithInc",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/api/report/getDetailDataByCompany",method:"get",params:{companyId:e}})}function y(e){return Object(r["a"])({url:"/api/report/getReportDataByCompany",method:"get",params:{companyId:e}})}function b(){return Object(r["a"])({url:"/api/report/colors",method:"get"})}function h(e,t){var a=e.row,r=e.column;if(r&&r.property){a[r.property],a[r.property+"2"];var n=a[r.property+"Inc"];r.property.endsWith("Inc")&&(n=a[r.property]);var l="font-weight: bold;color: #ffffff";if(null!=n){var o=null;for(var c in t){var s=t[c];if(1==s.type&&n>s.level||2==s.type&&n<s.level){o=s.color;break}}for(var i in t){var u=t[i];if(0==u.type&&u.level==n){o=u.color;break}}return null!=o?"background-color: ".concat(o,";")+l:""}}}},fa5c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"searchArea"},[a("el-col",{attrs:{span:10}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择改制企业"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.companySelectType,callback:function(t){e.companySelectType=t},expression:"companySelectType"}},e._l(e.companySearchOptions.fixedGroup,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择项目"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.queryParams.head,callback:function(t){e.$set(e.queryParams,"head",t)},expression:"queryParams.head"}},e._l(e.heads,(function(e){return a("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1)],1)],1),a("el-row",[a("el-form-item",{attrs:{label:"手动选择"}},[a("el-popover",{attrs:{width:"800",trigger:"click"}},[a("div",[a("div",{staticStyle:{"text-align":"right"}},[a("el-link",{attrs:{type:"primary"},on:{click:e.clearShow}},[e._v("清除")])],1),a("el-checkbox-group",{model:{value:e.companysToShow,callback:function(t){e.companysToShow=t},expression:"companysToShow"}},e._l(e.companysToShowChoose,(function(t){return a("el-checkbox",{key:t.id,staticStyle:{width:"16%"},attrs:{label:t.id,value:t.id}},[e._v(e._s(t.shortName))])})),1)],1),a("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("点击选择")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"每次显示"}},[a("el-input-number",{attrs:{min:1,max:10},model:{value:e.queryParams.max,callback:function(t){e.$set(e.queryParams,"max",t)},expression:"queryParams.max"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"刷新时间（秒）"}},[a("el-input-number",{attrs:{min:3,max:1e3},model:{value:e.queryParams.refresh,callback:function(t){e.$set(e.queryParams,"refresh",t)},expression:"queryParams.refresh"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"固定Y轴"}},[a("el-radio-group",{model:{value:e.queryParams.fixY,callback:function(t){e.$set(e.queryParams,"fixY",t)},expression:"queryParams.fixY"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),a("el-radio",{attrs:{label:0}},[e._v("否，自动调整Y轴")])],1)],1)],1)],1)],1)],1),a("el-col",{staticStyle:{padding:"0 0 0 20px"},attrs:{span:14}},[a("div",{attrs:{id:"chart"}})])],1),a("el-row",{staticStyle:{height:"55vh"}},[a("h4",[e._v(e._s(e.year)+"年改制企业"+e._s(e.pageTitle)+"月报")]),"jyjc"!=e.pageType?a("el-table",{ref:"table",staticClass:"table",attrs:{data:e.companyReportDataList,height:"43vh"},on:{"cell-mouse-enter":function(t){e.cellMouseIn=!0},"cell-mouse-leave":function(t){e.cellMouseIn=!1}}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"公司名称",align:"left",width:"100",prop:"companyName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.showDlg(t.row)}}},[e._v(e._s(t.row.companyName))])]}}],null,!1,583698967)}),e._l(e.heads,(function(t){return a("el-table-column",{key:t.dictValue,attrs:{label:t.dictLabel,align:"center",prop:t.dictValue,formatter:e.persentFormatter}})}))],2):e._e(),"jyjc"==e.pageType?a("el-table",{ref:"table",staticClass:"table",attrs:{data:e.companyReportDataList,height:"43vh"},on:{"cell-mouse-enter":function(t){e.cellMouseIn=!0},"cell-mouse-leave":function(t){e.cellMouseIn=!1}}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"公司名称",align:"left",width:"100",prop:"companyShortName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.showDlg(t.row)}}},[e._v(e._s(t.row.companyShortName))])]}}],null,!1,1955836133)}),a("el-table-column",{attrs:{label:"年份",align:"center",prop:"year",width:"120"}}),a("el-table-column",{attrs:{label:"职工队伍结构",align:"center"}},[a("el-table-column",{attrs:{label:"职工总数",align:"center",prop:"zgzs"}}),a("el-table-column",{attrs:{label:"改制职工月末人数",align:"center",prop:"gzzg"}}),a("el-table-column",{attrs:{label:"安置油田子女人数",align:"center",prop:"azzn"}}),a("el-table-column",{attrs:{label:"安置协解职工人数",align:"center",prop:"azzg"}}),a("el-table-column",{attrs:{label:"自行招聘人数",align:"center",prop:"zxzp"}})],1),a("el-table-column",{attrs:{label:"改制职工退休人数",align:"center",prop:"gztx"}}),a("el-table-column",{attrs:{label:"资产结构",align:"center"}},[a("el-table-column",{attrs:{label:"月末总资产",align:"center",prop:"ymzzc"}}),a("el-table-column",{attrs:{label:"月末净资产",align:"center",prop:"ymjzc"}})],1),a("el-table-column",{attrs:{label:"收入结构",align:"center"}},[a("el-table-column",{attrs:{label:"油田内部市场收入",align:"center",prop:"nbsr"}}),a("el-table-column",{attrs:{label:"外部市场收入",align:"center",prop:"wbsr"}}),a("el-table-column",{attrs:{label:"改制企业之间收入",align:"center",prop:"qyjsr"}}),a("el-table-column",{attrs:{label:"国际市场收入",align:"center",prop:"gjsr"}}),a("el-table-column",{attrs:{label:"当年合计",align:"center",prop:"dnhj"}})],1),a("el-table-column",{attrs:{label:"利税情况",align:"center"}},[a("el-table-column",{attrs:{label:"当年利润累计",align:"center",prop:"dnlr"}}),a("el-table-column",{attrs:{label:"当年已交税金累计",align:"center",prop:"dnsj"}})],1)],1):e._e()],1),a("el-dialog",{attrs:{title:e.companyReportDataDlgList[0]["companyName"]+e.companyReportDataDlgList[e.companyReportDataDlgList.length-1]["year"]+"年-"+e.companyReportDataDlgList[0]["year"]+"年"+e.pageTitle+"月报",visible:e.dlgOpen,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.dlgOpen=t}}},["jyjc"!=e.pageType?a("el-table",{ref:"table",staticClass:"table",attrs:{data:e.companyReportDataDlgList,height:"400"},on:{"cell-mouse-enter":function(t){e.cellMouseIn=!0},"cell-mouse-leave":function(t){e.cellMouseIn=!1}}},[a("el-table-column",{attrs:{label:"年份",align:"left",prop:"year"}}),e._l(e.heads,(function(t){return a("el-table-column",{key:t.dictValue,attrs:{label:t.dictLabel,align:"center",prop:t.dictValue,formatter:e.persentFormatter}})}))],2):e._e(),"jyjc"==e.pageType?a("el-table",{ref:"table",staticClass:"table",attrs:{data:e.companyReportDataDlgList,height:"400"},on:{"cell-mouse-enter":function(t){e.cellMouseIn=!0},"cell-mouse-leave":function(t){e.cellMouseIn=!1}}},[a("el-table-column",{attrs:{label:"年份",align:"center",prop:"year",width:"120"}}),a("el-table-column",{attrs:{label:"职工队伍结构",align:"center"}},[a("el-table-column",{attrs:{label:"职工总数",align:"center",prop:"zgzs"}}),a("el-table-column",{attrs:{label:"改制职工月末人数",align:"center",prop:"gzzg"}}),a("el-table-column",{attrs:{label:"安置油田子女人数",align:"center",prop:"azzn"}}),a("el-table-column",{attrs:{label:"安置协解职工人数",align:"center",prop:"azzg"}}),a("el-table-column",{attrs:{label:"自行招聘人数",align:"center",prop:"zxzp"}})],1),a("el-table-column",{attrs:{label:"改制职工退休人数",align:"center",prop:"gztx"}}),a("el-table-column",{attrs:{label:"资产结构",align:"center"}},[a("el-table-column",{attrs:{label:"月末总资产",align:"center",prop:"ymzzc"}}),a("el-table-column",{attrs:{label:"月末净资产",align:"center",prop:"ymjzc"}})],1),a("el-table-column",{attrs:{label:"收入结构",align:"center"}},[a("el-table-column",{attrs:{label:"油田内部市场收入",align:"center",prop:"nbsr"}}),a("el-table-column",{attrs:{label:"外部市场收入",align:"center",prop:"wbsr"}}),a("el-table-column",{attrs:{label:"改制企业之间收入",align:"center",prop:"qyjsr"}}),a("el-table-column",{attrs:{label:"国际市场收入",align:"center",prop:"gjsr"}}),a("el-table-column",{attrs:{label:"当年合计",align:"center",prop:"dnhj"}})],1),a("el-table-column",{attrs:{label:"利税情况",align:"center"}},[a("el-table-column",{attrs:{label:"当年利润累计",align:"center",prop:"dnlr"}}),a("el-table-column",{attrs:{label:"当年已交税金累计",align:"center",prop:"dnsj"}})],1)],1):e._e()],1)],1)},n=[],l=a("c14f"),o=a("1da1"),c=(a("4de4"),a("d81d"),a("fb6a"),a("b0c0"),a("b680"),a("d3b7"),a("0643"),a("2382"),a("4e3e"),a("a573"),a("159b"),a("a6fc")),s=a("313e"),i={name:"CompanyReportData",components:{},data:function(){return{companysToShowChoose:[],companysToShow:[],dlgOpen:!1,chartInterval:null,chartTimeout:null,loading:!0,ids:[],cellMouseIn:!1,single:!0,multiple:!0,showSearch:!0,pageType:"",total:0,companySelectType:null,companySearchOptions:{},companyReportDataList:[],companyReportDataDlgList:[{}],validYears:[{}],yearMarks:{},year:"",scrollInterval:null,title:"",pageTitle:"",heads:[],open:!1,queryParams:{pageNum:1,pageSize:15,companyIds:[],head:"",yearRange:[],max:5,refresh:10,fixY:0},chart:{},chartMaxCount:5,form:{},rules:{}}},created:function(){var e=this;return Object(o["a"])(Object(l["a"])().m((function t(){var a,r,n;return Object(l["a"])().w((function(t){while(1)switch(t.n){case 0:return a=e,t.n=1,c["m"](!1);case 1:r=t.v,a.validYears=r.data,a.queryParams.yearRange=[r.data[0]["year"],r.data[r.data.length-1]["year"]],r.data.forEach((function(e){a.yearMarks[e.year]=e.year+""})),setTimeout((function(){var e=document.getElementById("chart");a.chart=s["init"](e)})),a.pageType=a.$route.name.split("/").pop(),n=a.pageType,t.n="jyjc"===n?2:"pjjc"===n?3:"jjxy"===n?4:"jyfz"===n?5:6;break;case 2:return a.queryParams.head="dnhj",a.pageTitle="经营监测",a.getDicts("jyybheads").then((function(e){a.heads=e.data})),t.a(3,6);case 3:return a.queryParams.head="zhfz",a.pageTitle="评价监测",a.getDicts("zhheads").then((function(e){e.data.unshift({dictValue:"zhfz",dictLabel:"综合分值"}),a.heads=e.data})),t.a(3,6);case 4:return a.pageTitle="经济效益监测",a.queryParams.head="jjxy",a.getDicts("jjxyheads").then((function(e){e.data.unshift({dictValue:"jjxy",dictLabel:"综合分值"}),a.heads=e.data})),t.a(3,6);case 5:return a.pageTitle="经营发展监测",a.queryParams.head="jyfz",a.getDicts("jyfzheads").then((function(e){e.data.unshift({dictValue:"jyfz",dictLabel:"综合分值"}),a.heads=e.data})),t.a(3,6);case 6:return t.n=7,e.getCompanySearchOptions();case 7:e.getList();case 8:return t.a(2)}}),t)})))()},watch:{companySelectType:function(){var e=this;"other"!=e.companySelectType&&(e.queryParams.companyIds=e.companySearchOptions.fixedGroup.filter((function(t){return t.value==e.companySelectType}))[0]["companyIds"],e.companysToShowChoose=e.companySearchOptions.companyList.filter((function(t){return e.queryParams.companyIds.indexOf(t.id)>-1})),e.companysToShow=e.queryParams.companyIds)},companysToShow:function(){this.getList()},queryParams:{handler:function(){this.getList()},deep:!0}},methods:{showDlg:function(e){var t=this;return Object(o["a"])(Object(l["a"])().m((function a(){var r,n;return Object(l["a"])().w((function(a){while(1)switch(a.n){case 0:r=null,n=t.pageType,a.n="jyjc"===n?1:3;break;case 1:return a.n=2,c["k"](e.companyId);case 2:return r=a.v,a.a(3,5);case 3:return a.n=4,c["h"](e.companyId);case 4:return r=a.v,a.a(3,5);case 5:t.companyReportDataDlgList=r.data,t.dlgOpen=!0;case 6:return a.a(2)}}),a)})))()},clearShow:function(){this.companysToShow=[]},persentFormatter:function(e,t){var a=e[t.property];if("zhfz"==t.property||"jyfz"==t.property||"jjxy"==t.property)try{return a.toFixed(2)}catch(r){return a}else try{return(100*a).toFixed(2)+"%"}catch(r){return a}},initChart:function(){var e=this;return Object(o["a"])(Object(l["a"])().m((function t(){var a,r,n,o,s,i,u,p,m,d,y;return Object(l["a"])().w((function(t){while(1)switch(t.n){case 0:d=function(){var e=r.data.series.filter((function(e){return a.companysToShow.indexOf(e.compId)>-1}));return n.series=e.slice(m,m+a.queryParams.max),n.series.push(p),console.log("chart refresh"),console.log(n.series),a.fillChart(n),m+=a.queryParams.max,m>e.length-1&&(m=0),d},a=e,r=null,y=a.pageType,t.n="jyjc"===y?1:3;break;case 1:return t.n=2,c["g"](a.queryParams);case 2:return r=t.v,t.a(3,5);case 3:return t.n=4,c["i"](a.queryParams);case 4:return r=t.v,t.a(3,5);case 5:for(u in n={title:{text:""},tooltip:{trigger:"axis"},legend:{data:[]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:r.data.xAxis},yAxis:{type:"value"},series:[]},o=0,s=0,i=[],r.data.series.forEach((function(e){e.data=e.data.slice(0,r.data.xAxis.length),e.smooth=!1;for(var t=0;t<e.data.length;t++){var a=parseInt(e.data[t]||0);i[t]?i[t]+=a:i[t]=a,a>o&&(o=a),a<s&&(s=a)}})),i)i[u]=parseInt(i[u]/r.data.series.length);p={data:i,name:"平均",type:"line",itemStyle:{color:"#00ff00",borderWidth:5}},a.queryParams.fixY&&(n.yAxis.max=parseInt(1.2*o),n.yAxis.min=s),m=0;try{clearInterval(a.chartInterval)}catch(l){}a.chartInterval=setInterval(d(),1e3*a.queryParams.refresh);case 6:return t.a(2)}}),t)})))()},fillChart:function(e){var t=this,a=t.heads.filter((function(e){return e.dictValue==t.queryParams.head}))[0]["dictLabel"];e.legend.data=e.series.map((function(e){return e.name})),e.title.text=a,t.chart.setOption(e,!0)},getCompanySearchOptions:function(){var e=this;return Object(o["a"])(Object(l["a"])().m((function t(){var a,r;return Object(l["a"])().w((function(t){while(1)switch(t.n){case 0:return a=e,t.n=1,c["f"]();case 1:r=t.v,a.companySearchOptions=r.data,a.queryParams.companyIds=a.companySearchOptions.fixedGroup.filter((function(e){return"slyt"==e.value}))[0]["companyIds"],a.companySelectType="slyt";case 2:return t.a(2)}}),t)})))()},getList:function(){var e=this;return Object(o["a"])(Object(l["a"])().m((function t(){var a,r;return Object(l["a"])().w((function(t){while(1)switch(t.n){case 0:e.loading=!0,a=null,r=e.pageType,t.n="jyjc"===r?1:"pjjc"===r||"jjxy"===r||"jyfz"===r?3:5;break;case 1:return t.n=2,c["d"](e.queryParams);case 2:return a=t.v,t.a(3,5);case 3:return t.n=4,c["j"](e.queryParams);case 4:return a=t.v,t.a(3,5);case 5:e.companyReportDataList=a.data;try{e.year=e.companyReportDataList[0]["year"]}catch(n){}e.loading=!1,e.initChart(),e.startScroll();case 6:return t.a(2)}}),t)})))()},startScroll:function(){var e=this;setTimeout((function(){setTimeout((function(){var t=e.$refs["table"],a=t.bodyWrapper;e.scrollInterval&&clearInterval(e.scrollInterval);var r=0;a.scrollTop=0,e.scrollInterval=setInterval((function(){if(1!=e.cellMouseIn){if(a.scrollTop+=1,r==a.scrollTop)return a.scrollTop=0,void(r=0);r=a.scrollTop,a.clientHeight+a.scrollTop==a.scrollHeight&&(a.scrollTop=0)}}),40)}))}))}}},u=i,p=(a("6a97"),a("2877")),m=Object(p["a"])(u,r,n,!1,null,"2212b98b",null);t["default"]=m.exports}}]);