<link href="/css/car-detail.css" rel="stylesheet">
<link rel="canonical" href="${ogUrl!''}">
<div class="car-detail" id="app">
    <div class="main-title-container">
        <div class="first-title">
            {{ dealerInfo.dealerName || 'ÂÑ™Ë≥™‰∫åÊâãËªäÂïÜ' }} /
        </div>
        <div class="second-title">
            {{ carInfo.saleTitle || (carInfo.manufactureYear + 'Âπ¥ ' + carInfo.brand + ' ' + carInfo.customModel) || 'ËªäËºõË©≥ÊÉÖ' }}
        </div>
    </div>
    
    <!-- Á¨¨‰∏ÄË°åÔºöÂõæÁâáÂíå‰ø°ÊÅØ -->
    <div class="row mb-4">
        <!-- Â∑¶‰æßÂõæÁâáËΩÆÊí≠ -->
        <div class="col-md-6">
            <div class="swiper-wrapper-container" @mouseenter="stopAutoPlay" @mouseleave="startAutoPlay">
                <div class="swiper-container">
                    <div class="swiper-wrapper">
                        <div v-for="(image, index) in images" 
                             :key="index"
                             class="swiper-slide"
                             :class="{ active: currentImageIndex === index }">
                            <div class="image-container">
                                <img class="swiper_image" 
                                     :src="image" 
                                     :alt="carInfo.saleTitle || 'Ê±ΩËªäÂúñÁâá'"
                                     @click="openLightbox(index)"
                                     @error="handleImageError">
                            </div>
                        </div>
                        <!-- Â¶ÇÊûúÊ≤°ÊúâÂõæÁâáÔºåÊòæÁ§∫ÈªòËÆ§ÂõæÁâá -->
                        <div v-if="!images || images.length === 0" class="swiper-slide active">
                            <div class="image-container">
                                <img class="swiper_image" 
                                     src="/img/car/car4.jpg" 
                                     alt="Ê±ΩËªäÂúñÁâá"
                                     @error="handleImageError">
                            </div>
                        </div>
                    </div>
                    <!-- Ëº™Êí≠ÂúñÂØºËà™ÊåâÈíÆ -->
                    <div class="swiper-button-prev" v-if="images && images.length > 1" @click="prevImage"></div>
                    <div class="swiper-button-next" v-if="images && images.length > 1" @click="nextImage"></div>
                    <!-- Ëº™Êí≠ÂúñÊåáÁ§∫Âô® -->
                    <div class="swiper-pagination" v-if="images && images.length > 1">
                        <span v-for="(image, index) in images" 
                              :key="index"
                              class="swiper-pagination-bullet"
                              :class="{ active: currentImageIndex === index }"
                              @click="changeImage(index)"></span>
                    </div>
                </div>
                <div class="thumbnail-container" v-if="images && images.length > 1">
                    <img v-for="(image, index) in images" 
                         :key="index"
                         :src="getThumbnailUrl(image)" 
                         class="thumbnail" 
                         :class="{ active: currentImageIndex === index }"
                         @click="changeImage(index)"
                         alt="Á∏ÆÁï•Âúñ">
                </div>
            </div>
            <!-- LineÂàÜ‰∫´ÊåâÈíÆ -->
            <div class="share-container">
                <div class="line-it-button" data-lang="zh_Hant" data-type="share-a" data-env="REAL"
                    data-og-url="https://sale.carce.cc/car/detail/{{ saleId }}"
                    data-url="https://sale.carce.cc/detail/{{ saleId }}"
                    data-color="default" data-size="large"
                    data-count="false" data-ver="3" style="display: none;"></div>
            </div>
        </div>
        
        <!-- Âè≥‰æß‰ø°ÊÅØ -->
        <div class="col-md-6">
            <h2 class="car-title">
                {{ carInfo.saleTitle || (carInfo.manufactureYear + 'Âπ¥ ' + carInfo.brand + ' ' + carInfo.customModel) || 'ËªäËºõË©≥ÊÉÖ' }}
            </h2>
            <div class="price mb-3">
                <span class="h4">$</span><span class="h4">
                    {{ carInfo.salePrice ? formatPrice(carInfo.salePrice) : 'Èù¢Ë≠∞' }}
                </span>
            </div>
            <div class="specs mb-3">
                <div class="row">
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">Âπ¥‰ªΩ</div>
                        <div class="spec-value">{{ carInfo.manufactureYear || '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">ÈáåÁ®ã</div>
                        <div class="spec-value">{{ carInfo.mileage ? formatMileage(carInfo.mileage) + ' km' : '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">ÊéíÈáè</div>
                        <div class="spec-value">{{ carInfo.displacement || '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">ËÆäÈÄüÁÆ±</div>
                        <div class="spec-value">{{ carInfo.transmission || '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">ÁáÉÊñô</div>
                        <div class="spec-value">{{ carInfo.fuelSystem || '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">È°èËâ≤</div>
                        <div class="spec-value">{{ carInfo.color || '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">ËªäÈñÄ</div>
                        <div class="spec-value">{{ carInfo.doorCount ? carInfo.doorCount + 'ÈñÄ' : '--' }}</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">Â∫ß‰Ωç</div>
                        <div class="spec-value">{{ carInfo.passengerCount ? carInfo.passengerCount + 'Â∫ß' : '--' }}</div>
                    </div>
                </div>
            </div>
            <div class="action-buttons d-flex w-100 mb-3">
                <button class="btn btn-line flex-fill ms-2" @click="openLineContact">
                    <i class="bi bi-chat-dots"></i> Âä†LINE
                </button>
                <button class="btn btn-phone flex-fill ms-2" @click="openPhoneContact">
                    <i class="bi bi-telephone"></i> ÈõªË©±ËÅØÁµ°
                </button>
                <button class="btn btn-appointment flex-fill ms-2" @click="openAppointmentModal">
                    <i class="bi bi-calendar-check"></i> È†êÁ¥ÑÁúãËªä
                </button>
                <button class="btn btn-report flex-fill ms-2" @click="openReportModal">
                    <i class="bi bi-exclamation-triangle"></i> Ê™¢ËàâÂ∫óÂÆ∂
                </button>
            </div>
            <div class="dealer-info mt-3 text-left">
                <div class="dealer-contact">ËÅØÁµ°‰∫∫Ôºö {{ dealerInfo.contactPerson || 'ÂºµÁ∂ìÁêÜ' }}</div>
                <div class="dealer-address">
                    Ë≥ûËªäÂú∞ÂùÄÔºö {{ dealerInfo.publicAddress || 'Âè∞ÂåóÂ∏Ç‰ø°Áæ©ÂçÄ‰ø°Áæ©Ë∑Ø‰∫îÊÆµ7Ëôü' }}
                    üìç<a :href="'https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(dealerInfo.publicAddress || 'Âè∞ÂåóÂ∏Ç‰ø°Áæ©ÂçÄ‰ø°Áæ©Ë∑Ø‰∫îÊÆµ7Ëôü')" target="_blank">Êü•ÁúãÂú∞Âúñ</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Á¨¨‰∏âË°åÔºöÂäüËÉΩÂùóÂíåÂπøÂëäÂùó -->
    <div class="features-ads-section mb-4">
        <div class="container-fluid">
            <div class="row">
                <!-- Â∑¶‰æßÂäüËÉΩÂùóÂå∫Âüü (2/3) -->
                <div class="col-md-8" style="padding: 2px">
                    <div class="features-section">
                        <div class="row">
                            <div class="col-12 mb-3" 
                                 v-for="(feature, index) in features" :key="feature.id">
                                <div class="feature-card">
                                    <!-- titleType=0 Êó∂ÊòæÁ§∫ÂõæÁâáÂíåÊ†áÈ¢ò -->
                                    <template v-if="feature.titleType === 0">
                                        <div class="feature-image-container">
                                            <img :src="feature.imageUrl" :alt="feature.title" class="feature-image" 
                                                 @error="handleImageError($event, feature.title)">
                                            <h3 class="feature-title" v-text="feature.title"></h3>
                                        </div>
                                    </template>
                                    <!-- titleType=1 Êó∂ÊòæÁ§∫HTMLÂÜÖÂÆπ -->
                                    <template v-else-if="feature.titleType === 1">
                                        <div class="feature-html-container">
                                            <div class="feature-html-content" v-html="feature.titleHtml"></div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Âè≥‰æßÂπøÂëäÂùóÂå∫Âüü (1/3) -->
                <div class="col-md-4">
                    <div class="ad-section">
                        <div class="row">
                            <div class="col-12 mb-3" 
                                 v-for="(ad, index) in advertisements" :key="ad.id">
                                <div class="ad-card" :data-ad-id="ad.id">
                                    <!-- ÈÄ£ÁµêÈ°ûÂûãÂπøÂëä -->
                                    <a v-if="ad.isLink === 1" :href="ad.linkUrl" class="ad-link" target="_blank">
                                        <img :src="ad.imageUrl" :alt="ad.title" class="ad-image" 
                                             @error="handleImageError($event, ad.title)">
                                        <div v-if="ad.title" class="ad-title-overlay" style="display: none;" v-text="ad.title"></div>
                                        <div v-if="ad.title" class="ad-title-bottom" v-text="ad.title"></div>
                                    </a>
                                    <!-- ÂÖßÂÆπÈ°ûÂûãÂπøÂëä -->
                                    <div v-else class="ad-content-link" @click="showAdContent(ad.id, ad.title, ad.content)">
                                        <img :src="ad.imageUrl" :alt="ad.title" class="ad-image"
                                             @error="handleImageError($event, ad.title)">
                                        <div v-if="ad.title" class="ad-title-overlay" style="display: none;" v-text="ad.title"></div>
                                        <div v-if="ad.title" class="ad-title-bottom" v-text="ad.title"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Á¨¨ÂõõË°åÔºöTabÈ°µ -->
    <div class="tabs">
        <ul class="nav nav-tabs">
            <li class="nav-item" v-for="(tab, index) in tabs" :key="index">
                <a class="nav-link" :class="{ active: activeTab.code === tab.code }" @click="activeTab = tab">
                    {{ tab.title }}
                </a>
            </li>
        </ul>
        <div class="tab-content p-3 border border-top-0 rounded-bottom">
            <div v-show="activeTab.code === 'car_equipments'">
                <div class="equipment-header">
                    ËªäËºõÈÖçÂÇô
                </div>
                <div class="equipment-section" v-for="(equipment, index) in carEquipments" :key="index">
                    <div class="equipment-row d-flex flex-column flex-md-row">
                        <div class="equipment-name">{{ equipment.name }}</div>
                        <div class="equipment-tags">
                            <span class="equipment-tag" v-for="(tag, tagIndex) in equipment.tags" :key="tagIndex">
                                <i class="iconfont">&#xe632;</i> {{ tag }}
                            </span>
                        </div>
                    </div>
                </div>
                <div class="equipment-header">
                    Ë≥£ÂÆ∂‰øùË≠â
                </div>
                <div class="guarantee-tags">
                    <div class="guarantee-section" v-for="(gur, index) in carGuarantees" :key="index">
                        <div class="guarantee-name"><i class="iconfont">&#xe632;</i>{{ gur.itemName }}</div>
                        <div class="guarantee-desc">
                            {{ gur.description }}
                        </div>
                    </div>
                </div>
                <div class="equipment-header">
                    ËªäËºõÊèèËø∞
                </div>
                <iframe ref="contentFrame" class="content-frame" :srcdoc="getHtmlContent(carInfo.saleDescription)"
                    frameborder="0" width="100%"></iframe>
                <div style="height: 1em;"></div>
            </div>
            
            <div v-show="activeTab.code === 'dealer_intro'">
                <div class="dealer-container">
                    <div class="dealer-intro">
                        <div class="dealer-intro-row">
                            <div class="dealer-title">Â∫óÂÆ∂ÂêçÁ®±</div>
                            <div class="dealer-content">{{ dealerInfo.dealerName || '--' }}</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">Â∫óÂÆ∂Âú∞ÂùÄ</div>
                            <div class="dealer-content">{{ dealerInfo.publicAddress || '--' }}</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">ËÅØÁµ°‰∫∫</div>
                            <div class="dealer-content">{{ dealerInfo.contactPerson || '--' }}</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">Â∫óÂÆ∂ÈõªË©±</div>
                            <div class="dealer-content">{{ dealerInfo.companyPhone || '--' }}</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">ÊâãÊ©ü</div>
                            <div class="dealer-content">{{ dealerInfo.companyMobile || '--' }}</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">LINE</div>
                            <div class="dealer-content">
                                <button class="btn-line-id" @click="contactLine" @mouseenter="lineIdHover = true"
                                    @mouseleave="lineIdHover = false" v-if="dealerInfo.lineId">
                                    <i class="bi bi-chat-dots"></i> {{ lineIdHover ? dealerInfo.lineId : 'LINEËÅØÁµ°Êàë' }}
                                </button>
                                <span v-else>--</span>
                            </div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">Á∂≤ÂùÄ</div>
                            <div class="dealer-content">{{ dealerInfo.website || '--' }}</div>
                        </div>
                    </div>
                    <div class="dealer-cover">
                        <img :src="dealerInfo.coverImage" alt="Â∫óÂÆ∂Â∞ÅÈù¢">
                    </div>
                </div>
                <iframe ref="dealerContentFrame" class="content-frame"
                    :srcdoc="getHtmlContent(dealerInfo.description)" frameborder="0" width="100%"></iframe>
            </div>
        </div>
    </div>
    
    <!-- È¢ÑÁ∫¶ÁúãËΩ¶ÂºπÁ™ó -->
    <div class="modal fade" id="appointmentModal" tabindex="-1" aria-labelledby="appointmentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-start" id="appointmentModalLabel">
                        <i class="bi bi-calendar-check me-2"></i>È†êÁ¥ÑÁúãËªä
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="appointmentForm">
                        <div class="mb-3">
                            <label for="appointmentDate" class="form-label">
                                <i class="bi bi-calendar me-2"></i>È†êÁ¥ÑÊó•Êúü
                            </label>
                            <input type="date" class="form-control" id="appointmentDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="appointmentTime" class="form-label">
                                <i class="bi bi-clock me-2"></i>È†êÁ¥ÑÊôÇÈñì
                            </label>
                            <select class="form-control" id="appointmentTime" required>
                                <option value="">Ë´ãÈÅ∏ÊìáÊôÇÈñì</option>
                                <option value="09:00">09:00</option>
                                <option value="10:00">10:00</option>
                                <option value="11:00">11:00</option>
                                <option value="14:00">14:00</option>
                                <option value="15:00">15:00</option>
                                <option value="16:00">16:00</option>
                                <option value="17:00">17:00</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="appointmentPhone" class="form-label">
                                <i class="bi bi-telephone me-2"></i>ËÅØÁµ°ÈõªË©±
                            </label>
                            <input type="tel" class="form-control" id="appointmentPhone" 
                                   placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÊâãÊ©üËôüÁ¢º" 
                                   value="<#if user?? && user?has_content>${user.phone!''}</#if>" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">
                                <i class="bi bi-person me-2"></i>ËÅØÁµ°‰∫∫
                            </label>
                            <div class="form-control-plaintext" id="appointmentNameDisplay">
                                <#if user?? && user?has_content>
                                    ${user.name!'Êú™ËÆæÁΩÆÂßìÂêç'}
                                <#else>
                                    <span class="text-danger">ËØ∑ÂÖàÁôªÂΩï</span>
                                </#if>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="appointmentNote" class="form-label">
                                <i class="bi bi-chat-text me-2"></i>ÂÇôË®ª
                            </label>
                            <textarea class="form-control" id="appointmentNote" rows="3" 
                                      placeholder="Â¶ÇÊúâÁâπÊÆäÈúÄÊ±ÇË´ãÂú®Ê≠§Ë™™Êòé"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂèñÊ∂à</button>
                    <button type="button" class="btn btn-success" @click="submitAppointment">
                        <i class="bi bi-check-circle me-2"></i>Êèê‰∫§È†êÁ¥Ñ
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ÊàêÂäüÊèêÁ§∫ÂºπÁ™ó -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="success-icon mb-3">
                        <i class="bi bi-check-circle-fill"></i>
                    </div>
                    <h5 class="modal-title">È†êÁ¥ÑÊàêÂäüÔºÅ</h5>
                    <p class="text-muted">ÊàëÂÄëÊúÉÁõ°Âø´ËàáÊÇ®ËÅØÁπ´Á¢∫Ë™çÈ†êÁ¥ÑË©≥ÊÉÖ„ÄÇ</p>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Á¢∫ÂÆö</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ê™¢ËàâÂºπÁ™ó -->
    <div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-start" id="reportModalLabel">
                        <i class="bi bi-flag me-2"></i>Ê™¢ËàâËªäËºõ
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="reportForm">
                        <div class="mb-3">
                            <label for="reportReason" class="form-label">
                                <i class="bi bi-exclamation-triangle me-2"></i>Ê™¢ËàâÂéüÂõ†
                            </label>
                            <select class="form-control" id="reportReason" required>
                                <option value="">Ë´ãÈÅ∏ÊìáÊ™¢ËàâÂéüÂõ†</option>
                                <option value="price_mismatch">ÂÉπÊ†ºËàáÁèæÂ†¥‰∏çÁ¨¶</option>
                                <option value="false_info">Ë≥áÊñôËôõÂÅá</option>
                                <option value="fraud_suspicion">Ë©êÈ®ôÂ´åÁñë</option>
                                <option value="other">ÂÖ∂ÂÆÉ</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="reportDescription" class="form-label">
                                <i class="bi bi-chat-text me-2"></i>Ë©≥Á¥∞Ë™™Êòé
                            </label>
                            <textarea class="form-control" id="reportDescription" rows="4" 
                                      placeholder="Ë´ãË©≥Á¥∞ÊèèËø∞Ê™¢ËàâÂéüÂõ†ÔºåÊèê‰æõÊõ¥Â§öË≥áË®äÊúâÂä©ÊñºÊàëÂÄëËôïÁêÜÊÇ®ÁöÑÊ™¢Ëàâ" required></textarea>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="reportAnonymous">
                                <label class="form-check-label" for="reportAnonymous">
                                    ÂåøÂêçÊ™¢Ëàâ
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂèñÊ∂à</button>
                    <button type="button" class="btn btn-danger" @click="submitReport">
                        <i class="bi bi-flag me-2"></i>Êèê‰∫§Ê™¢Ëàâ
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SEOÊèèËø∞ -->
    <section class="seo-description" style="display:none">
        <p><#if carInfo.saleDescription??>${carInfo.saleDescription?replace('<[^>]*>', '', 'r')?replace('\\s+', ' ', 'r')?trim}</#if><#if carInfo.saleDescription?? && ogDescription??>,</#if><#if ogDescription??>${ogDescription?replace('<[^>]*>', '', 'r')?replace('\\s+', ' ', 'r')?trim}</#if></p>
    </section>
</div>
<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "Product",
  "name": "${ogTitle}",
  "image": "https://testcloud.carce.cc/img/car_sale/sell_car_68d4ac5db7cc01.55690246.jpg",
  "description": "<#if carInfo.saleDescription??>${carInfo.saleDescription?replace('<[^>]*>', '', 'r')?replace('\\s+', ' ', 'r')?trim}</#if><#if carInfo.saleDescription?? && ogDescription??>,</#if><#if ogDescription??>${ogDescription?replace('<[^>]*>', '', 'r')?replace('\\s+', ' ', 'r')?trim}</#if>",
  "brand": {
    "@type": "Brand",
    "name": "${carInfo.brand}"
  },
  "offers": {
    "@type": "Offer",
    "url": "${ogUrl}",
    "priceCurrency": "TWD",
    "price": "50000",
    "availability": "https://schema.org/InStock",
    "seller": {
      "@type": "Organization",
      "name": "Â∞èÊòé‰∫åÊâãËªä"
    }
  }
}
</script>
<script>
console.log('VueÁâàÊú¨:', Vue.version);
console.log('ÂºÄÂßãÂàùÂßãÂåñVueÂÆû‰æã...');

try {
    new Vue({
    el: '#app',
    data: {
        carInfo: <#if carInfoJson??>${carInfoJson}<#else>{
            saleTitle: '',
            brand: '',
            customModel: '',
            manufactureYear: '',
            salePrice: null,
            mileage: null,
            displacement: '',
            transmission: '',
            fuelSystem: '',
            color: '',
            doorCount: null,
            passengerCount: null,
            saleDescription: '',
            coverImage: ''
        }</#if>,
        images: <#if imagesJson??>${imagesJson}<#else>[]</#if>,
        equipments: <#if equipmentsJson??>${equipmentsJson}<#else>[]</#if>,
        guarantees: <#if guaranteesJson??>${guaranteesJson}<#else>[]</#if>,
        dealerInfo: <#if dealerInfoJson??>${dealerInfoJson}<#else>{}</#if>,
        saleId: <#if saleId??>${saleId}<#else>null</#if>,
        activeTab: { code: 'car_equipments', title: 'ËªäËºõÈÖçÂÇô' },
        loading: false,
        currentImageIndex: 0,
        tabs: [
            { code: 'car_equipments', title: 'ËªäËºõÈÖçÂÇô' },
            { code: 'dealer_intro', title: 'Â∫óÂÆ∂‰ªãÁ¥π' }
        ],
        carEquipments: <#if equipmentsJson??>${equipmentsJson}<#else>[]</#if>,
        carGuarantees: <#if guaranteesJson??>${guaranteesJson}<#else>[]</#if>,
        lineIdHover: false,
        autoPlayTimer: null,
        autoPlayInterval: 5000,
        features: [],
        advertisements: []
    },
    mounted() {
        console.log('ËΩ¶ËæÜËØ¶ÊÉÖÈ°µVueÂÆû‰æãÂ∑≤ÊåÇËΩΩ');
        console.log('VueÂÆû‰æãÊï∞ÊçÆ:', this.$data);
        console.log('VueÂÆû‰æãÊñπÊ≥ï:', Object.keys(this.$options.methods));
        
        
        this.initializePage();
        this.startAutoPlay();
        this.getFeatures();
        this.getAdvertisements();
        
        // ÊµãËØïVueÂÆû‰æãÊòØÂê¶Ê≠£Â∏∏Â∑•‰Ωú
        setTimeout(() => {
            console.log('VueÂÆû‰æãÊµãËØï - 3ÁßíÂêéÊâßË°å');
            const testButton = document.querySelector('[data-test="vue-test"]');
            if (testButton) {
                console.log('ÊâæÂà∞ÊµãËØïÊåâÈíÆ');
            }
        }, 3000);
    },
    computed: {
        // Ëé∑ÂèñÁ∫ØÊñáÊú¨ÊèèËø∞
        plainTextDescription() {
            if (!this.carInfo.saleDescription) return '';
            // ÂàõÂª∫‰∏¥Êó∂divÂÖÉÁ¥†Êù•Ëß£ÊûêHTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = this.carInfo.saleDescription;
            return tempDiv.textContent || tempDiv.innerText || '';
        }
    },
    methods: {
        // ÂàùÂßãÂåñÈ°µÈù¢
        initializePage() {
            // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫ÊòéÂ§©
            const appointmentDateInput = document.getElementById('appointmentDate');
            if (appointmentDateInput) {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                appointmentDateInput.value = tomorrow.toISOString().split('T')[0];
            }
            
            // ÂàùÂßãÂåñÁ∏ÆÁï•ÂúñÁÇπÂáª‰∫ã‰ª∂
            this.initializeThumbnails();
        },
        
        // ÂàùÂßãÂåñÁ∏ÆÁï•Âúñ
        initializeThumbnails() {
            // Ëøô‰∏™ÊñπÊ≥ïÁé∞Âú®Áî±VueÁöÑ@click‰∫ã‰ª∂Â§ÑÁêÜÔºå‰∏çÂÜçÈúÄË¶ÅÊâãÂä®ÁªëÂÆö‰∫ã‰ª∂
        },
        
        // ÂàáÊç¢ÂõæÁâá
        changeImage(index) {
            this.currentImageIndex = index;
        },
        
        // ‰∏ä‰∏ÄÂº†ÂõæÁâá
        prevImage() {
            if (this.images && this.images.length > 0) {
                this.currentImageIndex = this.currentImageIndex > 0 ? this.currentImageIndex - 1 : this.images.length - 1;
            }
        },
        
        // ‰∏ã‰∏ÄÂº†ÂõæÁâá
        nextImage() {
            if (this.images && this.images.length > 0) {
                this.currentImageIndex = this.currentImageIndex < this.images.length - 1 ? this.currentImageIndex + 1 : 0;
            }
        },
        
        // ÂºÄÂßãËá™Âä®ËΩÆÊí≠
        startAutoPlay() {
            if (this.images && this.images.length > 1) {
                this.autoPlayTimer = setInterval(() => {
                    this.nextImage();
                }, this.autoPlayInterval);
            }
        },
        
        // ÂÅúÊ≠¢Ëá™Âä®ËΩÆÊí≠
        stopAutoPlay() {
            if (this.autoPlayTimer) {
                clearInterval(this.autoPlayTimer);
                this.autoPlayTimer = null;
            }
        },
        
        // ÊâìÂºÄÁÅØÁÆ±
        openLightbox(index) {
            // ÁÆÄÂçïÁöÑÂõæÁâáÊü•ÁúãÂäüËÉΩÔºåÂèØ‰ª•ÂêéÁª≠Êâ©Â±ï‰∏∫Êõ¥Â§çÊùÇÁöÑÁÅØÁÆ±ÁªÑ‰ª∂
            if (this.images && this.images.length > 0) {
                window.open(this.images[index], '_blank');
            }
        },
        
        // ËÆæÁΩÆÊ¥ªÂä®Ê†áÁ≠æÈ°µ
        setActiveTab(tab) {
            this.activeTab = tab;
        },
        
        // Ëé∑ÂèñHTMLÂÜÖÂÆπ
        getHtmlContent(htmlContent) {
            if (!htmlContent) return '';
            return htmlContent;
        },
        
        // Ëé∑ÂèñÁ∫ØÊñáÊú¨ÂÜÖÂÆπÔºàÂéªÈô§HTMLÊ†áÁ≠æÔºâ
        getPlainText(htmlContent) {
            if (!htmlContent) return '';
            // ÂàõÂª∫‰∏¥Êó∂divÂÖÉÁ¥†Êù•Ëß£ÊûêHTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;
            return tempDiv.textContent || tempDiv.innerText || '';
        },
        
        // ËÅîÁ≥ªLine
        contactLine() {
            if (this.dealerInfo.lineId) {
                window.open('https://line.me/ti/p/' + this.dealerInfo.lineId, '_blank');
            }
        },
        
        // ÊâìÂºÄLINEËÅîÁ≥ª
        openLineContact() {
            if (!this.dealerInfo.lineId) {
                alert('Â∫óÂÆ∂Êú™Êèê‰æõLINE ID');
                return;
            }
            
            // Ê£ÄÊµãËÆæÂ§áÁ±ªÂûã
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // ÁßªÂä®ËÆæÂ§áÔºöÁõ¥Êé•ÊâìÂºÄLINEÂ∫îÁî®
                window.location.href = 'https://line.me/ti/p/' + this.dealerInfo.lineId;
            } else {
                // PCËÆæÂ§áÔºöÊâìÂºÄLINEÁΩëÈ°µÁâà
                window.open('https://line.me/ti/p/' + this.dealerInfo.lineId, '_blank');
            }
        },
        
        // ÊâìÂºÄÁîµËØùËÅîÁ≥ª
        openPhoneContact() {
            if (!this.dealerInfo.companyMobile) {
                alert('Â∫óÂÆ∂Êú™Êèê‰æõËÅîÁ≥ªÁîµËØù');
                return;
            }
            
            // Ê£ÄÊµãËÆæÂ§áÁ±ªÂûã
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // ÁßªÂä®ËÆæÂ§áÔºöÁõ¥Êé•Êã®Âè∑
                window.location.href = 'tel:' + this.dealerInfo.companyMobile;
            } else {
                // PCËÆæÂ§áÔºöÊòæÁ§∫ÁîµËØùÂè∑Á†Å
                alert('ËÅîÁ≥ªÁîµËØùÔºö' + this.dealerInfo.companyMobile);
            }
        },
        
        // Â§ÑÁêÜÂõæÁâáÂä†ËΩΩÂ§±Ë¥•
        handleImageError(event) {
            console.log('ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§ÂõæÁâá');
            event.target.src = '/img/car/car4.jpg';
        },
        
        // Ëé∑ÂèñÂäüËÉΩÂùóÊï∞ÊçÆ
        getFeatures() {
            let _this = this;
            $.ajax({
                url: '/api/advertisement/list',
                method: 'GET',
                success: (data) => {
                    // ËøáÊª§Âá∫ advType=1 ÁöÑÊï∞ÊçÆÔºåÂèñÂâç2‰∏™
                    const filteredFeatures = data.data.filter(ad => ad.advType === 1).slice(0, 2);
                    _this.features = filteredFeatures;
                },
                error: (error) => {
                    console.log('Ëé∑ÂèñÂäüËÉΩÂùóÊï∞ÊçÆÂ§±Ë¥•:', error);
                }
            });
        },
        
        // Ëé∑ÂèñÂπøÂëäÊï∞ÊçÆ
        getAdvertisements() {
            let _this = this;
            $.ajax({
                url: '/api/advertisement/list',
                method: 'GET',
                success: (data) => {
                    // ËøáÊª§Âá∫ advType=0 ÁöÑÊï∞ÊçÆÔºåÂèñÂâç2‰∏™
                    const filteredAds = data.data.filter(ad => ad.advType === 0).slice(0, 2);
                    _this.advertisements = filteredAds;
                },
                error: (error) => {
                    console.log('Ëé∑ÂèñÂπøÂëäÊï∞ÊçÆÂ§±Ë¥•:', error);
                }
            });
        },
        
        // È°ØÁ§∫Âª£ÂëäÂÖßÂÆπ
        showAdContent(adId, title, content) {
            // Ê™¢Êü•adIdÊòØÂê¶ÊúâÊïà
            if (!adId || adId === 'null' || adId === '') {
                console.error('Âª£ÂëäIDÁÑ°Êïà:', adId);
                return;
            }
            // ÊâìÈñãÊñ∞Á™óÂè£È°ØÁ§∫Âª£ÂëäÂÖßÂÆπÈ†ÅÈù¢
            window.open('/ad-content/' + adId, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
        },
        
        // Ëé∑ÂèñÁº©Áï•ÂõæURL
        getThumbnailUrl(originalUrl) {
            if (!originalUrl) return '';
            
            // Ê£ÄÊü•URLÊòØÂê¶Â∑≤ÁªèÂåÖÂê´_90x90ÂêéÁºÄ
            if (originalUrl.includes('_90x90.')) {
                return originalUrl;
            }
            
            // Ëé∑ÂèñÊñá‰ª∂Êâ©Â±ïÂêç
            const lastDotIndex = originalUrl.lastIndexOf('.');
            if (lastDotIndex === -1) {
                return originalUrl;
            }
            
            // Âú®Êâ©Â±ïÂêçÂâçÊèíÂÖ•_90x90
            const baseUrl = originalUrl.substring(0, lastDotIndex);
            const extension = originalUrl.substring(lastDotIndex);
            
            return baseUrl + '_90x90' + extension;
        },
        
        // ÊâìÂºÄÊ™¢ËàâÂºπÁ™ó
        openReportModal() {
            // Ê£ÄÊü•Áî®Êà∑ÊòØÂê¶Â∑≤ÁôªÂΩï
            <#if user??>
                // Â∑≤ÁôªÂΩïÔºåÊâìÂºÄÊ™¢ËàâÂºπÁ™ó
                const modal = new bootstrap.Modal(document.getElementById('reportModal'));
                modal.show();
            <#else>
                // Êú™ÁôªÂΩïÔºåÊèêÁ§∫Áî®Êà∑ÂÖàÁôªÂΩï
                alert('Ë´ãÂÖàÁôªÂÖ•ÂæåÂÜçÈÄ≤Ë°åÊ™¢Ëàâ');
                return;
            </#if>
        },
        
        // Êèê‰∫§Ê™¢Ëàâ
        async submitReport() {
            const reason = document.getElementById('reportReason').value;
            const description = document.getElementById('reportDescription').value;
            const anonymous = document.getElementById('reportAnonymous').checked;
            
            if (!reason) {
                alert('Ë´ãÈÅ∏ÊìáÊ™¢ËàâÂéüÂõ†');
                return;
            }
            
            if (!description.trim()) {
                alert('Ë´ãÂ°´ÂØ´Ë©≥Á¥∞Ë™™Êòé');
                return;
            }
            
            const reportData = {
                saleId: this.saleId,
                reason: reason,
                description: description.trim(),
                anonymous: anonymous,
                reporterId: <#if user??>${user.id}<#else>null</#if>
            };
            
            try {
                console.log('Êèê‰∫§Ê™¢ËàâÊï∏Êìö:', reportData);
                const response = await axios.post('/api/report/create', reportData);
                console.log('Ê™¢ËàâÊèê‰∫§ÈüøÊáâ:', response.data);
                
                if (response.data.success) {
                    // ÂÖ≥Èó≠Ê™¢ËàâÂºπÁ™ó
                    const reportModalElement = document.getElementById('reportModal');
                    if (reportModalElement) {
                        const reportModal = bootstrap.Modal.getInstance(reportModalElement);
                        if (reportModal) {
                            reportModal.hide();
                        } else {
                            // Â§áÁî®ÊñπÊ°àÔºöÁõ¥Êé•ÈöêËóèÂºπÁ™ó
                            reportModalElement.style.display = 'none';
                            document.body.classList.remove('modal-open');
                            const backdrop = document.querySelector('.modal-backdrop');
                            if (backdrop) {
                                backdrop.remove();
                            }
                        }
                    }
                    
                    // Ê∏ÖÁ©∫Ë°®Âçï
                    document.getElementById('reportForm').reset();
                    
                    // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                    alert('Ê™¢ËàâÂ∑≤Êèê‰∫§ÔºåÊàëÂÄëÊúÉÁõ°Âø´ËôïÁêÜÊÇ®ÁöÑÊ™¢Ëàâ');
                } else {
                    alert('Ê™¢ËàâÊèê‰∫§Â§±ÊïóÔºö' + (response.data.message || 'Êú™Áü•ÈåØË™§'));
                }
            } catch (error) {
                console.error('Ê™¢ËàâÊèê‰∫§ÈåØË™§:', error);
                alert('Ê™¢ËàâÊèê‰∫§Â§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶');
            }
        },
        
        // Ê†ºÂºèÂåñ‰ª∑Ê†º
        formatPrice(price) {
            if (!price) return '0';
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        },
        
        // Ê†ºÂºèÂåñÈáåÁ®ã
        formatMileage(mileage) {
            if (!mileage) return '0';
            return mileage.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        },
        
        
        // ÊâìÂºÄÈ¢ÑÁ∫¶ÂºπÁ™ó
        openAppointmentModal() {
            // Ê£ÄÊü•Áî®Êà∑ÊòØÂê¶ÁôªÂΩï
            const userNameDisplay = document.getElementById('appointmentNameDisplay');
            if (!userNameDisplay) {
                console.error('Êâæ‰∏çÂà∞Áî®Êà∑ÂêçÁß∞ÊòæÁ§∫ÂÖÉÁ¥†');
                return;
            }
            
            const isLoggedIn = !userNameDisplay.querySelector('.text-danger');
            
            if (!isLoggedIn) {
                // Êú™ÁôªÂΩïÔºåÊòæÁ§∫ÊèêÁ§∫Âπ∂Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ
                if (confirm('ÊÇ®Â∞öÊú™ÁôªÂΩïÔºåÊòØÂê¶Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢Ôºü')) {
                    // Ëé∑ÂèñÂΩìÂâçÈ°µÈù¢URL‰Ωú‰∏∫ËøîÂõûÂú∞ÂùÄ
                    const currentUrl = window.location.pathname + window.location.search;
                    window.location.href = '/login?returnUrl=' + encodeURIComponent(currentUrl);
                }
                return;
            }
            
            // Â∑≤ÁôªÂΩïÔºåÊâìÂºÄÈ¢ÑÁ∫¶ÂºπÁ™ó
            const modal = new bootstrap.Modal(document.getElementById('appointmentModal'));
            modal.show();
        },
        
        // ÊµãËØïÊñπÊ≥ï
        testMethod() {
            console.log('ÊµãËØïÊñπÊ≥ïË¢´Ë∞ÉÁî®');
            console.log('ÂΩìÂâçVueÂÆû‰æã:', this);
            console.log('saleId:', this.saleId);
            alert('VueÂÆû‰æãÊ≠£Â∏∏Â∑•‰ΩúÔºÅsaleId: ' + this.saleId);
        },
        
        // Êèê‰∫§È¢ÑÁ∫¶
        async submitAppointment() {
            console.log('submitAppointment ÊñπÊ≥ïË¢´Ë∞ÉÁî®');
            
            const form = document.getElementById('appointmentForm');
            if (!form) {
                console.error('Êâæ‰∏çÂà∞È¢ÑÁ∫¶Ë°®Âçï');
                return;
            }
            
            // È™åËØÅË°®Âçï
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            // Ëé∑ÂèñË°®ÂçïÊï∞ÊçÆ
            const appointmentDate = document.getElementById('appointmentDate')?.value || '';
            const appointmentTime = document.getElementById('appointmentTime')?.value || '';
            const appointmentPhone = document.getElementById('appointmentPhone')?.value || '';
            const appointmentName = document.getElementById('appointmentNameDisplay')?.textContent?.trim() || '';
            const appointmentNote = document.getElementById('appointmentNote')?.value || '';
            
            console.log('Ë°®ÂçïÊï∞ÊçÆ:', {
                appointmentDate,
                appointmentTime,
                appointmentPhone,
                appointmentName,
                appointmentNote,
                saleId: this.saleId
            });
            
            // ÁªÑÂêàÊó•ÊúüÂíåÊó∂Èó¥
            const appointmentDateTime = new Date(appointmentDate + 'T' + appointmentTime);
            
            const appointmentData = {
                carSaleId: this.saleId,
                appointmentName: appointmentName,
                appointmentPhone: appointmentPhone,
                appointmentTime: appointmentDateTime.toISOString(),
                appointmentNote: appointmentNote
            };
            
            console.log('ÂáÜÂ§áÊèê‰∫§ÁöÑÈ¢ÑÁ∫¶Êï∞ÊçÆ:', appointmentData);
            
            try {
                // Êèê‰∫§È¢ÑÁ∫¶Âà∞ÂêéÁ´Ø
                const response = await axios.post('/appointment/api/create', appointmentData);
                console.log('È¢ÑÁ∫¶Êèê‰∫§ÂìçÂ∫î:', response.data);
                
                if (response.data.success) {
                    // ÂÖ≥Èó≠È¢ÑÁ∫¶ÂºπÁ™ó
                    const appointmentModalElement = document.getElementById('appointmentModal');
                    if (appointmentModalElement) {
                        const appointmentModal = bootstrap.Modal.getInstance(appointmentModalElement);
                        if (appointmentModal) {
                            appointmentModal.hide();
                        } else {
                            // Â§áÁî®ÊñπÊ°àÔºöÁõ¥Êé•ÈöêËóèÂºπÁ™ó
                            appointmentModalElement.style.display = 'none';
                            document.body.classList.remove('modal-open');
                            const backdrop = document.querySelector('.modal-backdrop');
                            if (backdrop) {
                                backdrop.remove();
                            }
                        }
                    }
                    
                    // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                    alert('È†êÁ¥ÑÊàêÂäüÔºÅÊàëÂÄëÊúÉÁõ°Âø´ËàáÊÇ®ËÅØÁπ´Á¢∫Ë™çÈ†êÁ¥ÑË©≥ÊÉÖ„ÄÇ');
                    
                    // ÈáçÁΩÆË°®Âçï
                    form.reset();
                    
                    // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫ÊòéÂ§©
                    const appointmentDateInput = document.getElementById('appointmentDate');
                    if (appointmentDateInput) {
                        const tomorrow = new Date();
                        tomorrow.setDate(tomorrow.getDate() + 1);
                        appointmentDateInput.value = tomorrow.toISOString().split('T')[0];
                    }
                } else {
                    alert('È¢ÑÁ∫¶Â§±Ë¥•Ôºö' + response.data.message);
                }
            } catch (error) {
                console.error('Êèê‰∫§È¢ÑÁ∫¶Â§±Ë¥•:', error);
                alert('È¢ÑÁ∫¶Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï');
            }
        }
    }
});
} catch (error) {
    console.error('VueÂÆû‰æãÂàùÂßãÂåñÂ§±Ë¥•:', error);
    alert('È°µÈù¢ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï');
}
</script>

<style>
/* Âä®‰ΩúÊåâÈíÆÂÆπÂô®Ê†∑Âºè */
.action-buttons {
    display: flex;
    width: 100%;
    margin-bottom: 1rem;
}

/* Ê£ÄËΩ¶Êä•ÂëäÊåâÈíÆÊ†∑Âºè */
.btn-report {
    background-color: #6f42c1;
    border: none;
    color: white;
    border-radius: 10px;
    padding: 0.75rem 1rem;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.btn-report:hover {
    background-color: #5a32a3;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(111, 66, 193, 0.4);
    color: white;
}

/* È¢ÑÁ∫¶ÊåâÈíÆÊ†∑Âºè - ‰ΩøÁî®ÁΩëÁ´ô‰∏ªËâ≤Ë∞É */
.btn-appointment {
    background-color: #5ACFC9;
    border: none;
    color: white;
    border-radius: 10px;
    padding: 0.75rem 1rem;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.btn-appointment:hover {
    background-color: #4AB8B2;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(90, 207, 201, 0.4);
    color: white;
}

/* È¢ÑÁ∫¶ÂºπÁ™óÊ†∑Âºè */
.modal-content {
    border-radius: 15px;
    border: none;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.modal-header {
    background: linear-gradient(135deg, #5ACFC9 0%, #4AB8B2 100%);
    color: white;
    border-radius: 15px 15px 0 0;
    border: none;
}

.modal-title {
    font-weight: 600;
}

.btn-close {
    filter: invert(1);
}

/* ÊàêÂäüÊèêÁ§∫ÂºπÁ™óÊ†∑Âºè */
.success-icon {
    font-size: 4rem;
    color: #28a745;
}

#successModal .modal-content {
    border: none;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

#successModal .modal-body {
    padding: 2rem;
}

/* Ë°®ÂçïÊ†∑Âºè‰ºòÂåñ */
.form-control:focus {
    border-color: #5ACFC9;
    box-shadow: 0 0 0 0.2rem rgba(90, 207, 201, 0.25);
}

.form-label {
    font-weight: 600;
    color: #333;
    text-align: left !important;
    width: 100% !important;
    display: block !important;
}

/* ËÅîÁ≥ª‰∫∫ÊòæÁ§∫Ê†∑Âºè */
.form-control-plaintext {
    background-color: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 0.75rem 1rem;
    color: #495057;
    font-weight: 500;
}

 .form-control-plaintext .text-danger {
     font-weight: 600;
 }
 
 /* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 768px) {
    .modal-dialog {
        margin: 1rem;
    }
    
    .action-buttons {
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .action-buttons .flex-fill {
        width: 100%;
    }
    
    .action-buttons .me-2,
    .action-buttons .ms-2 {
        margin-left: 0 !important;
        margin-right: 0 !important;
    }
    
    .btn-appointment,
    .btn-report {
        padding: 0.75rem 1rem;
        font-size: 1rem;
        width: 100%;
        margin-bottom: 0;
    }
    
    .modal-xl {
        max-width: 95%;
    }
    
    .specs .row {
        margin: 0;
    }
    
    .specs .row > div {
        padding: 0.25rem 0.5rem;
    }
}

/* ÂäüËÉΩÂùóÂíåÂπøÂëäÂùóÊ†∑Âºè */
.features-ads-section {
    padding: 20px 0;
}

.feature-card {
    text-align: center;
    padding: 8px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    height: 100%;
    border: 1px solid rgba(0,0,0,0.05);
    position: relative;
    overflow: visible;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
}

.feature-image-container {
    position: relative;
    overflow: hidden;
    height: 200px;
}

.feature-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
}

.feature-title {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0,0,0,0.7));
    color: white;
    padding: 1rem;
    margin: 0;
    font-size: 1.1rem;
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
}

.feature-html-container {
    width: 100%;
    height: auto;
    margin: 0;
    padding: 15px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
}

.feature-html-content {
    width: 100%;
    height: auto;
    display: block;
    overflow: auto;
    text-align: left;
}

.feature-card:has(.feature-html-container) {
    height: auto;
    padding-bottom: 0;
}

.ad-card {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    height: 200px;
    position: relative;
    padding: 0;
}

.ad-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 15px rgba(0,0,0,0.2);
}

.ad-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.ad-title-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
    text-align: center;
    padding: 20px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.ad-card:hover .ad-title-overlay {
    opacity: 1;
}

.ad-title-bottom {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    color: white;
    padding: 20px 15px 15px;
    font-size: 1.2rem;
    font-weight: bold;
    text-align: center;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
    transform: translateY(0);
    transition: all 0.3s ease;
}

.ad-card:hover .ad-title-bottom {
    transform: translateY(-5px);
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
}

.ad-link {
    display: block;
    width: 100%;
    height: 100%;
    text-decoration: none;
    color: inherit;
    position: relative;
}

.ad-link:hover {
    text-decoration: none;
    color: inherit;
}

.ad-content-link {
    cursor: pointer;
    display: block;
    width: 100%;
    height: 100%;
}

@media (max-width: 576px) {
    .btn-appointment,
    .btn-report {
        font-size: 0.9rem;
        padding: 0.65rem 1rem;
    }
    
    .car-title {
        font-size: 1.5rem;
    }
    
    .price .h4 {
        font-size: 1.5rem;
    }
}
</style>

