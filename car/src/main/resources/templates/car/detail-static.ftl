<link href="/css/car-detail.css" rel="stylesheet">
<div class="car-detail">
    <div class="main-title-container">
        <div class="first-title">
            å„ªè³ªäºŒæ‰‹è»Šå•† /
        </div>
        <div class="second-title">
            2020å¹´ Toyota Camry 2.5L è±ªè¯ç‰ˆ
        </div>
    </div>
    
    <!-- ç¬¬ä¸€è¡Œï¼šå›¾ç‰‡å’Œä¿¡æ¯ -->
    <div class="row mb-4">
        <!-- å·¦ä¾§å›¾ç‰‡è½®æ’­ -->
        <div class="col-md-6">
            <div class="swiper-wrapper-container">
                <div class="swiper-container">
                    <img style="width:100%;aspect-ratio: 3/2;" class="swiper_image" src="/img/car/car4.jpg" alt="æ±½è½¦å›¾ç‰‡">
                </div>
                <div class="thumbnail-container">
                    <img src="/img/car/car4.jpg" class="thumbnail active" alt="ç¼©ç•¥å›¾">
                    <img src="/img/car/car5.jpg" class="thumbnail" alt="ç¼©ç•¥å›¾">
                    <img src="/img/car/car6.jpg" class="thumbnail" alt="ç¼©ç•¥å›¾">
                    <img src="/img/car/car7.jpg" class="thumbnail" alt="ç¼©ç•¥å›¾">
                    <img src="/img/car/car8.jpg" class="thumbnail" alt="ç¼©ç•¥å›¾">
                </div>
            </div>
            <!-- Lineåˆ†äº«æŒ‰é’® -->
            <div class="share-container">
                <div class="line-it-button" data-lang="zh_Hant" data-type="share-a" data-env="REAL"
                    data-og-url="https://sale.carce.cc/car/preview/static-demo"
                    data-url="https://sale.carce.cc/static-demo"
                    data-color="default" data-size="large"
                    data-count="false" data-ver="3" style="display: none;"></div>
            </div>
        </div>
        
        <!-- å³ä¾§ä¿¡æ¯ -->
        <div class="col-md-6">
            <h2 class="car-title">2020å¹´ Toyota Camry 2.5L è±ªè¯ç‰ˆ
            </h2>
            <div class="price mb-3">
                <span class="h4">$</span><span class="h4">850,000
                </span>
            </div>
            <div class="specs mb-3">
                <div class="row">
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">å¹´ä»½</div>
                        <div class="spec-value">2020</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">é‡Œç¨‹</div>
                        <div class="spec-value">45,000 km</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">æ’é‡</div>
                        <div class="spec-value">2.5L</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">è®Šé€Ÿç®±</div>
                        <div class="spec-value">è‡ªå‹•</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">ç‡ƒæ–™</div>
                        <div class="spec-value">æ±½æ²¹</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">é¡è‰²</div>
                        <div class="spec-value">ç™½è‰²</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">è»Šé–€</div>
                        <div class="spec-value">4é–€</div>
                    </div>
                    <div class="col-6 col-sm-6 col-md-4 col-lg-3 mb-3">
                        <div class="spec-name text-muted">åº§ä½</div>
                        <div class="spec-value">5åº§</div>
                    </div>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-report" onclick="openReportModal()">
                    <i class="bi bi-file-earmark-text"></i> æª¢è»Šå ±å‘Š
                </button>
                <button class="btn btn-appointment" onclick="openAppointmentModal()">
                    <i class="bi bi-calendar-check"></i> é ç´„çœ‹è»Š
                </button>
            </div>
            <div class="dealer-info mt-3 text-left">
                <div class="dealer-contact">è¯çµ¡äººï¼š å¼µç¶“ç†
                </div>
                <div class="dealer-address">
                    è³è»Šåœ°å€ï¼š å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ
                    ğŸ“<a href="https://www.google.com/maps/search/?api=1&query=å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ" target="_blank">æŸ¥çœ‹åœ°åœ–</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ç¬¬ä¸‰è¡Œï¼šTabé¡µ -->
    <div class="tabs">
        <ul class="nav nav-tabs car-detail-tabs">
            <li class="nav-item">
                <a class="nav-link active" href="#equipment-tab">è»Šè¼›é…å‚™</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#dealer-tab">åº—å®¶ä»‹ç´¹</a>
            </li>
        </ul>
        <div class="tab-content p-3 border border-top-0 rounded-bottom">
            <div id="equipment-tab" class="tab-pane active">
                <div class="equipment-header">
                    è»Šè¼›é…å‚™
                </div>
                <div class="equipment-section">
                    <div class="equipment-row d-flex flex-column flex-md-row">
                        <div class="equipment-name">å®‰å…¨é…å‚™</div>
                        <div class="equipment-tags">
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> å®‰å…¨æ°£å›Š
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> ABSé˜²é–æ­»ç…è»Š
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> é›»å­ç©©å®šæ§åˆ¶
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> å€’è»Šå½±åƒ
                            </span>
                        </div>
                    </div>
                </div>
                <div class="equipment-section">
                    <div class="equipment-row d-flex flex-column flex-md-row">
                        <div class="equipment-name">èˆ’é©é…å‚™</div>
                        <div class="equipment-tags">
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> é›»å‹•åº§æ¤…
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> é›™å€æ†æº«ç©ºèª¿
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> å…¨æ™¯å¤©çª—
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> çœŸçš®åº§æ¤…
                            </span>
                        </div>
                    </div>
                </div>
                <div class="equipment-section">
                    <div class="equipment-row d-flex flex-column flex-md-row">
                        <div class="equipment-name">ç§‘æŠ€é…å‚™</div>
                        <div class="equipment-tags">
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> å°èˆªç³»çµ±
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> è—ç‰™é€£æ¥
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> ç„¡ç·šå……é›»
                            </span>
                            <span class="equipment-tag">
                                <i class="iconfont">&#xe632;</i> æ™ºèƒ½é‘°åŒ™
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="equipment-header">
                    è³£å®¶ä¿è­‰
                </div>
                <div class="guarantee-tags">
                    <div class="guarantee-section">
                        <div class="guarantee-name">
                            <i class="iconfont">&#xe632;</i>ç„¡é‡å¤§äº‹æ•…
                        </div>
                        <div class="guarantee-desc">
                            æœ¬è»Šç„¡é‡å¤§äº‹æ•…è¨˜éŒ„ï¼Œè»Šèº«çµæ§‹å®Œæ•´ï¼Œå®‰å…¨æ€§èƒ½è‰¯å¥½ã€‚
                        </div>
                    </div>
                    <div class="guarantee-section">
                        <div class="guarantee-name">
                            <i class="iconfont">&#xe632;</i>é‡Œç¨‹çœŸå¯¦
                        </div>
                        <div class="guarantee-desc">
                            é‡Œç¨‹æ•¸çœŸå¯¦å¯é ï¼Œç„¡èª¿è¡¨è¨˜éŒ„ï¼Œå¯æä¾›å®Œæ•´ä¿é¤Šè¨˜éŒ„ã€‚
                        </div>
                    </div>
                    <div class="guarantee-section">
                        <div class="guarantee-name">
                            <i class="iconfont">&#xe632;</i>å“è³ªä¿è­‰
                        </div>
                        <div class="guarantee-desc">
                            æä¾›3å€‹æœˆå“è³ªä¿è­‰ï¼Œå¦‚æœ‰å•é¡Œå¯å…è²»ç¶­ä¿®æˆ–æ›´æ›ã€‚
                        </div>
                    </div>
                </div>
                
                <div class="equipment-header">
                    è»Šè¼›æè¿°
                </div>
                <div class="content-frame">
                    <p>é€™æ˜¯ä¸€è¼›2020å¹´å‡ºå» çš„Toyota Camry 2.5Lè±ªè¯ç‰ˆï¼Œè»Šæ³æ¥µä½³ï¼Œé‡Œç¨‹åƒ…45,000å…¬é‡Œã€‚</p>
                    <p><strong>è»Šæ³ç‰¹é»ï¼š</strong></p>
                    <ul>
                        <li>åŸå» ä¿é¤Šï¼Œå®šæœŸç¶­è­·</li>
                        <li>ç„¡é‡å¤§äº‹æ•…ï¼Œè»Šèº«å®Œæ•´</li>
                        <li>å…§è£ä¹¾æ·¨ï¼Œåº§æ¤…ç„¡ç£¨æ</li>
                        <li>å¼•æ“é‹è½‰é †æš¢ï¼Œè®Šé€Ÿç®±æ­£å¸¸</li>
                        <li>ç©ºèª¿ç³»çµ±è‰¯å¥½ï¼ŒéŸ³éŸ¿ç³»çµ±å®Œæ•´</li>
                    </ul>
                    <p><strong>é…å‚™ç‰¹è‰²ï¼š</strong></p>
                    <ul>
                        <li>2.5Lç›´åˆ—å››ç¼¸å¼•æ“ï¼Œå‹•åŠ›å……æ²›</li>
                        <li>8é€Ÿæ‰‹è‡ªæ’è®Šé€Ÿç®±ï¼Œæ›æª”é †æš¢</li>
                        <li>é›™å€æ†æº«ç©ºèª¿ç³»çµ±</li>
                        <li>å…¨æ™¯å¤©çª—ï¼Œæ¡å…‰è‰¯å¥½</li>
                        <li>çœŸçš®åº§æ¤…ï¼Œèˆ’é©åº¦ä½³</li>
                        <li>å€’è»Šå½±åƒç³»çµ±ï¼Œå®‰å…¨ä¾¿åˆ©</li>
                        <li>è—ç‰™éŸ³éŸ¿ç³»çµ±ï¼Œå¨›æ¨‚åŠŸèƒ½å®Œæ•´</li>
                    </ul>
                    <p><strong>é©åˆå°è±¡ï¼š</strong></p>
                    <p>é©åˆå®¶åº­ä½¿ç”¨ï¼Œå•†å‹™ä»£æ­¥ï¼Œé•·é€”æ—…è¡Œç­‰å„ç¨®ç”¨é€”ã€‚è»Šæ³è‰¯å¥½ï¼Œå€¼å¾—ä¿¡è³´ã€‚</p>
                </div>
            </div>
            
            <div id="dealer-tab" class="tab-pane">
                <div class="dealer-container">
                    <div class="dealer-intro">
                        <div class="dealer-intro-row">
                            <div class="dealer-title">åº—å®¶åç¨±</div>
                            <div class="dealer-content">å„ªè³ªäºŒæ‰‹è»Šå•†</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">åº—å®¶åœ°å€</div>
                            <div class="dealer-content">å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">è¯çµ¡äºº</div>
                            <div class="dealer-content">å¼µç¶“ç†</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">åº—å®¶é›»è©±</div>
                            <div class="dealer-content">02-2345-6789</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">æ‰‹æ©Ÿ</div>
                            <div class="dealer-content">0912-345-678</div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">LINE</div>
                            <div class="dealer-content">
                                <button class="btn-line-id">
                                    <i class="bi bi-chat-dots"></i> LINEè¯çµ¡æˆ‘
                                </button>
                            </div>
                        </div>
                        <div class="dealer-intro-row">
                            <div class="dealer-title">ç¶²å€</div>
                            <div class="dealer-content">www.qualitycars.com.tw</div>
                        </div>
                    </div>
                    <div class="dealer-cover">
                        <img src="/img/car/car9.jpg" alt="åº—å®¶å°é¢">
                    </div>
                </div>
                <div class="content-frame">
                    <p><strong>é—œæ–¼æˆ‘å€‘</strong></p>
                    <p>å„ªè³ªäºŒæ‰‹è»Šå•†æˆç«‹æ–¼2010å¹´ï¼Œå°ˆæ³¨æ–¼ä¸­é«˜ç´šäºŒæ‰‹è»Šçš„è²·è³£æ¥­å‹™ã€‚æˆ‘å€‘æ“æœ‰å°ˆæ¥­çš„è»Šè¼›æª¢æ¸¬åœ˜éšŠï¼Œç¢ºä¿æ¯è¼›è»Šéƒ½ç¶“éåš´æ ¼çš„å®‰å…¨æª¢æŸ¥ã€‚</p>
                    <p><strong>æœå‹™ç‰¹è‰²</strong></p>
                    <ul>
                        <li>å°ˆæ¥­è»Šè¼›æª¢æ¸¬ï¼Œç¢ºä¿è»Šæ³</li>
                        <li>æä¾›å®Œæ•´ä¿é¤Šè¨˜éŒ„</li>
                        <li>3å€‹æœˆå“è³ªä¿è­‰</li>
                        <li>å…è²»è©¦é§•æœå‹™</li>
                        <li>éˆæ´»çš„åˆ†æœŸä»˜æ¬¾æ–¹æ¡ˆ</li>
                        <li>å®Œå–„çš„å”®å¾Œæœå‹™</li>
                    </ul>
                    <p><strong>ç‡Ÿæ¥­æ™‚é–“</strong></p>
                    <p>é€±ä¸€è‡³é€±äº”ï¼š09:00-18:00<br>
                    é€±å…­ï¼š09:00-17:00<br>
                    é€±æ—¥ï¼š10:00-16:00</p>
                    <p><strong>äº¤é€šè³‡è¨Š</strong></p>
                    <p>æ·é‹ä¿¡ç¾©å®‰å’Œç«™æ­¥è¡Œ5åˆ†é˜å³å¯åˆ°é”ï¼Œé™„è¿‘è¨­æœ‰åœè»Šå ´ï¼Œæ–¹ä¾¿å®¢æˆ¶å‰ä¾†è³è»Šã€‚</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- é¢„çº¦çœ‹è½¦å¼¹çª— -->
<div class="modal fade" id="appointmentModal" tabindex="-1" aria-labelledby="appointmentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="appointmentModalLabel">
                    <i class="bi bi-calendar-check me-2"></i>é ç´„çœ‹è»Š
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="appointmentForm">
                    <div class="mb-3">
                        <label for="appointmentDate" class="form-label">
                            <i class="bi bi-calendar me-2"></i>é ç´„æ—¥æœŸ
                        </label>
                        <input type="date" class="form-control" id="appointmentDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="appointmentTime" class="form-label">
                            <i class="bi bi-clock me-2"></i>é ç´„æ™‚é–“
                        </label>
                        <select class="form-control" id="appointmentTime" required>
                            <option value="">è«‹é¸æ“‡æ™‚é–“</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="appointmentPhone" class="form-label">
                            <i class="bi bi-telephone me-2"></i>è¯çµ¡é›»è©±
                        </label>
                        <input type="tel" class="form-control" id="appointmentPhone" 
                               placeholder="è«‹è¼¸å…¥æ‚¨çš„æ‰‹æ©Ÿè™Ÿç¢¼" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">
                            <i class="bi bi-person me-2"></i>è¯çµ¡äºº
                        </label>
                        <div class="form-control-plaintext" id="appointmentNameDisplay">
                            <#if user?? && user?has_content>
                                ${user.name!'æœªè®¾ç½®å§“å'}
                            <#else>
                                <span class="text-danger">è¯·å…ˆç™»å½•</span>
                            </#if>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="appointmentNote" class="form-label">
                            <i class="bi bi-chat-text me-2"></i>å‚™è¨»
                        </label>
                        <textarea class="form-control" id="appointmentNote" rows="3" 
                                  placeholder="å¦‚æœ‰ç‰¹æ®Šéœ€æ±‚è«‹åœ¨æ­¤èªªæ˜"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" onclick="submitAppointment()">
                    <i class="bi bi-check-circle me-2"></i>æäº¤é ç´„
                </button>
            </div>
        </div>
    </div>
</div>

<!-- æ£€è½¦æŠ¥å‘Šå¼¹çª— -->
<div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reportModalLabel">
                    <i class="bi bi-file-earmark-text me-2"></i>æª¢è»Šå ±å‘Š
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="pdf-info-container">
                    <div class="text-center p-4">
                        <i class="bi bi-file-earmark-pdf text-primary" style="font-size: 4rem;"></i>
                        <h4 class="mt-3 mb-3">æª¢è»Šå ±å‘Š</h4>
                        <p class="text-muted mb-4">é€™ä»½æª¢è»Šå ±å‘ŠåŒ…å«äº†è»Šè¼›çš„è©³ç´°æª¢æ¸¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç™¼å‹•æ©Ÿã€è®Šé€Ÿç®±ã€åº•ç›¤ç­‰å„å€‹ç³»çµ±çš„æª¢æ¸¬çµæœã€‚</p>
                        
                        <div class="row g-3">
                            <div class="col-md-6">
                                <a href="/api/pdf/inspection-report" target="_blank" class="btn btn-primary btn-lg w-100">
                                    <i class="bi bi-eye me-2"></i>åœ¨ç·šæŸ¥çœ‹
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/api/pdf/inspection-report" download="æ£€è½¦æŠ¥å‘Š.pdf" class="btn btn-outline-primary btn-lg w-100">
                                    <i class="bi bi-download me-2"></i>ä¸‹è¼‰å ±å‘Š
                                </a>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <small class="text-muted">
                                <i class="bi bi-info-circle me-1"></i>
                                å ±å‘ŠåŒ…å«ï¼šç™¼å‹•æ©Ÿæª¢æ¸¬ã€è®Šé€Ÿç®±æª¢æ¸¬ã€åº•ç›¤æª¢æ¸¬ã€é›»å™¨ç³»çµ±æª¢æ¸¬ã€å¤–è§€æª¢æ¸¬ç­‰
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é—œé–‰</button>
            </div>
        </div>
    </div>
</div>

<!-- æˆåŠŸæç¤ºå¼¹çª— -->
<div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center">
                <div class="success-icon mb-3">
                    <i class="bi bi-check-circle-fill"></i>
                </div>
                <h5 class="modal-title">é ç´„æˆåŠŸï¼</h5>
                <p class="text-muted">æˆ‘å€‘æœƒç›¡å¿«èˆ‡æ‚¨è¯ç¹«ç¢ºèªé ç´„è©³æƒ…ã€‚</p>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">ç¢ºå®š</button>
            </div>
        </div>
    </div>
</div>

<script>
// ç®€å•çš„Tabåˆ‡æ¢åŠŸèƒ½
document.addEventListener('DOMContentLoaded', function() {
    // åªé€‰æ‹©è¯¦æƒ…é¡µå†…çš„tabå¯¼èˆªï¼Œé¿å…ä¸ä¸»å¸ƒå±€çš„å¯¼èˆªå†²çª
    const tabLinks = document.querySelectorAll('.car-detail-tabs .nav-link');
    const tabPanes = document.querySelectorAll('.tab-pane');
    
    tabLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // ç§»é™¤æ‰€æœ‰activeç±»
            tabLinks.forEach(l => l.classList.remove('active'));
            tabPanes.forEach(p => p.classList.remove('active'));
            
            // æ·»åŠ activeç±»åˆ°å½“å‰tab
            this.classList.add('active');
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
                targetElement.classList.add('active');
            }
        });
    });
    
    // ç¼©ç•¥å›¾ç‚¹å‡»åˆ‡æ¢
    const thumbnails = document.querySelectorAll('.thumbnail');
    const mainImage = document.querySelector('.swiper_image');
    
    if (thumbnails.length > 0 && mainImage) {
        thumbnails.forEach(thumb => {
            thumb.addEventListener('click', function() {
                // ç§»é™¤æ‰€æœ‰activeç±»
                thumbnails.forEach(t => t.classList.remove('active'));
                // æ·»åŠ activeç±»åˆ°å½“å‰ç¼©ç•¥å›¾
                this.classList.add('active');
                // æ›´æ–°ä¸»å›¾ç‰‡
                mainImage.src = this.src;
            });
        });
    }
    
    // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºæ˜å¤©
    const appointmentDateInput = document.getElementById('appointmentDate');
    if (appointmentDateInput) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        appointmentDateInput.value = tomorrow.toISOString().split('T')[0];
    }
});

// æ£€è½¦æŠ¥å‘ŠåŠŸèƒ½
function openReportModal() {
    const modal = new bootstrap.Modal(document.getElementById('reportModal'));
    modal.show();
}

// é¢„çº¦ç›¸å…³åŠŸèƒ½
function openAppointmentModal() {
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
    const userNameDisplay = document.getElementById('appointmentNameDisplay');
    if (!userNameDisplay) {
        console.error('æ‰¾ä¸åˆ°ç”¨æˆ·åç§°æ˜¾ç¤ºå…ƒç´ ');
        return;
    }
    
    const isLoggedIn = !userNameDisplay.querySelector('.text-danger');
    
    if (!isLoggedIn) {
        // æœªç™»å½•ï¼Œæ˜¾ç¤ºæç¤ºå¹¶è·³è½¬åˆ°ç™»å½•é¡µ
        if (confirm('æ‚¨å°šæœªç™»å½•ï¼Œæ˜¯å¦è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Ÿ')) {
            // è·å–å½“å‰é¡µé¢URLä½œä¸ºè¿”å›åœ°å€
            const currentUrl = window.location.pathname + window.location.search;
            window.location.href = '/login?returnUrl=' + encodeURIComponent(currentUrl);
        }
        return;
    }
    
    // å·²ç™»å½•ï¼Œæ‰“å¼€é¢„çº¦å¼¹çª—
    const modal = new bootstrap.Modal(document.getElementById('appointmentModal'));
    modal.show();
}

function submitAppointment() {
    const form = document.getElementById('appointmentForm');
    if (!form) {
        console.error('æ‰¾ä¸åˆ°é¢„çº¦è¡¨å•');
        return;
    }
    
    const formData = new FormData(form);
    
    // éªŒè¯è¡¨å•
    if (!form.checkValidity()) {
        form.reportValidity();
        return;
    }
    
    // è·å–è¡¨å•æ•°æ®
    const appointmentData = {
        date: document.getElementById('appointmentDate')?.value || '',
        time: document.getElementById('appointmentTime')?.value || '',
        phone: document.getElementById('appointmentPhone')?.value || '',
        name: document.getElementById('appointmentNameDisplay')?.textContent?.trim() || '',
        note: document.getElementById('appointmentNote')?.value || '',
        carTitle: '2020å¹´ Toyota Camry 2.5L è±ªåç‰ˆ'
    };
    
    // æ¨¡æ‹Ÿæäº¤é¢„çº¦
    console.log('é¢„çº¦æ•°æ®:', appointmentData);
    
    // å…³é—­é¢„çº¦å¼¹çª—
    const appointmentModalElement = document.getElementById('appointmentModal');
    if (appointmentModalElement) {
        const appointmentModal = bootstrap.Modal.getInstance(appointmentModalElement);
        if (appointmentModal) {
            appointmentModal.hide();
        }
    }
    
    // æ˜¾ç¤ºæˆåŠŸæç¤º
    const successModalElement = document.getElementById('successModal');
    if (successModalElement) {
        const successModal = new bootstrap.Modal(successModalElement);
        successModal.show();
    }
    
    // é‡ç½®è¡¨å•
    form.reset();
    
    // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºæ˜å¤©
    const appointmentDateInput = document.getElementById('appointmentDate');
    if (appointmentDateInput) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        appointmentDateInput.value = tomorrow.toISOString().split('T')[0];
    }
}
</script>

<style>
/* æ£€è½¦æŠ¥å‘ŠæŒ‰é’®æ ·å¼ */
.btn-report {
    background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);
    border: none;
    color: white;
    border-radius: 10px;
    padding: 0.75rem 1.5rem;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-report:hover {
    background: linear-gradient(135deg, #5a32a3 0%, #4a2d8a 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(111, 66, 193, 0.4);
    color: white;
}

/* é¢„çº¦æŒ‰é’®æ ·å¼ */
.btn-appointment {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    border: none;
    color: white;
    border-radius: 10px;
    padding: 0.75rem 1.5rem;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-appointment:hover {
    background: linear-gradient(135deg, #20c997 0%, #17a2b8 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
    color: white;
}

/* é¢„çº¦å¼¹çª—æ ·å¼ */
.modal-content {
    border-radius: 15px;
    border: none;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.modal-header {
    background: linear-gradient(135deg, #5ACFC9 0%, #4AB8B2 100%);
    color: white;
    border-radius: 15px 15px 0 0;
    border: none;
}

.modal-title {
    font-weight: 600;
}

.btn-close {
    filter: invert(1);
}

/* æˆåŠŸæç¤ºå¼¹çª—æ ·å¼ */
.success-icon {
    font-size: 4rem;
    color: #28a745;
}

#successModal .modal-content {
    border: none;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

#successModal .modal-body {
    padding: 2rem;
}

/* è¡¨å•æ ·å¼ä¼˜åŒ– */
.form-control:focus {
    border-color: #5ACFC9;
    box-shadow: 0 0 0 0.2rem rgba(90, 207, 201, 0.25);
}

.form-label {
    font-weight: 600;
    color: #333;
}

/* è”ç³»äººæ˜¾ç¤ºæ ·å¼ */
.form-control-plaintext {
    background-color: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 0.75rem 1rem;
    color: #495057;
    font-weight: 500;
}

.form-control-plaintext .text-danger {
    font-weight: 600;
}

/* PDFä¿¡æ¯å®¹å™¨æ ·å¼ */
.pdf-info-container {
    min-height: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.pdf-info-container .text-center {
    max-width: 500px;
}

.pdf-info-container i {
    color: #5ACFC9;
}

.pdf-info-container h4 {
    color: #495057;
    font-weight: 600;
}

.pdf-info-container .btn {
    border-radius: 10px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.pdf-info-container .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .modal-dialog {
        margin: 1rem;
    }
    
    .btn-appointment,
    .btn-report {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
    }
    

    
    .modal-xl {
        max-width: 95%;
    }
}
</style> 