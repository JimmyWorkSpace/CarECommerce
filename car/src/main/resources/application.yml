server:
  port: 8080
  servlet:
    context-path: /
  tomcat:
    uri-encoding: UTF-8
    accept-count: 1000
    threads:
      max: 800
      min-spare: 100
logging:
  level:
    cc.carce.sale: debug
    org.springframework: warn
spring:
  messages:
    basename: i18n/messages
  profiles:
    active: test
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 20MB
  devtools:
    restart:
      enabled: false
  datasource:
    # 基本连接池配置
    initialSize: 5
    minIdle: 5
    maxActive: 20
    maxWait: 60000
    
    # 连接检测配置
    timeBetweenEvictionRunsMillis: 60000
    minEvictableIdleTimeMillis: 300000
    maxEvictableIdleTimeMillis: 900000
    
    # 连接验证配置
    validationQuery: SELECT 1
    testWhileIdle: true
    testOnBorrow: true
    testOnReturn: false
    
    # 连接超时配置
    connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000;druid.stat.logSlowSql=true;druid.connectionTimeout=30000;druid.validationQueryTimeout=10000
    
    # 连接池监控
    webStatFilter:
      enabled: true
    statViewServlet:
      enabled: true
      allow: null
      url-pattern: /druid/*
      login-username: ruoyi
      login-password: 123456
    filter:
      stat:
        enabled: true
        log-slow-sql: true
        slow-sql-millis: 1000
        merge-sql: true
      wall:
        config:
          multi-statement-allow: true

  freemarker:
    template-loader-path: classpath:/templates/
    suffix: .ftl
    cache: false
    charset: UTF-8
    check-template-location: true
    content-type: text/html
    expose-request-attributes: false
    expose-session-attributes: false
    request-context-attribute: request
    expose-spring-macro-helpers: true
  redis:
    host: 127.0.0.1
    port: 6379
    database: 0
    timeout: 10s
    # 简化连接池配置，避免复杂的pool配置
    # lettuce:
    #   pool:
    #     min-idle: 0
    #     max-idle: 8
    #     max-active: 8
    #     max-wait: -1ms
mybatis:
  typeAliasesPackage: cc.carce.sale.entity
  mapperLocations: classpath*:mapper/**/*Mapper.xml
  configLocation: classpath:mybatis/mybatis-config.xml

# PageHelper分页配置
pagehelper:
  helper-dialect: mysql
  reasonable: true
  support-methods-arguments: true
  params: count=countSql
  page-size-zero: true

# Swagger配置
springfox:
  documentation:
    swagger-ui:
      enabled: true
    enabled: true

sms:
  url: https://smsb2c.mitake.com.tw/b2c/mtk/SmSend
  account: Dweizhe
  password: carce12345
  dealer-mobile: 0912345678  # 后台管理员手机号
