# 订单表字段更新说明

## 概述
根据提供的建表语句，对现有的 `car_order_info` 表进行了字段补充和调整，确保与建表语句完全一致。

## 主要更改

### 1. 实体类更新 (CarOrderInfoEntity.java)
- ✅ 实体类中已包含所有必要字段
- ✅ 字段类型和注释与建表语句一致

### 2. Mapper 接口更新 (CarOrderInfoMapper.java)
- ✅ 更新了 `updateLogisticsInfo` 方法签名，添加了新的收件人字段参数：
  - `receiverCity` - 收件人县市
  - `receiverDistrict` - 收件人区镇  
  - `receiverZipCode` - 收件人邮编

### 3. Mapper XML 更新 (CarOrderInfoMapper.xml)
- ✅ 在 `BaseResultMap` 中添加了缺失的字段映射：
  - `receiverCity` -> `receiverCity`
  - `receiverDistrict` -> `receiverDistrict`
  - `receiverZipCode` -> `receiverZipCode`
- ✅ 更新了 `Base_Column_List` 包含所有字段
- ✅ 更新了 `updateLogisticsInfo` SQL 语句以包含新的收件人字段

### 4. 服务层更新 (CarOrderInfoService.java)
- ✅ 保留了原有的 `updateLogisticsInfo` 方法以保持向后兼容性
- ✅ 添加了新的重载方法支持完整的收件人信息更新

### 5. 数据库表结构更新
创建了 `add_missing_order_fields.sql` 脚本，包含以下操作：
- 添加缺失的字段（如果不存在）
- 调整字段长度以匹配建表语句
- 添加必要的索引

## 字段对比

| 字段名 | 建表语句 | 原实体类 | 状态 |
|--------|----------|----------|------|
| id | bigint(20) | BIGINT(20) | ✅ 一致 |
| orderNo | varchar(50) | VARCHAR(50) | ✅ 一致 |
| userId | bigint(20) | BIGINT(20) | ✅ 一致 |
| totalPrice | int(10) | INT(11) | 🔄 需调整 |
| delFlag | bit(1) | BIT(1) | ✅ 一致 |
| createTime | datetime | DATETIME | ✅ 一致 |
| showOrder | int(11) | INT(11) | ✅ 一致 |
| orderStatus | int(11) | INT(11) | ✅ 一致 |
| receiverCity | varchar(50) | VARCHAR(1000) | 🔄 需调整 |
| receiverDistrict | varchar(50) | VARCHAR(1000) | 🔄 需调整 |
| receiverAddress | varchar(1000) | VARCHAR(1000) | ✅ 一致 |
| receiverName | varchar(255) | VARCHAR(255) | ✅ 一致 |
| receiverMobile | varchar(50) | VARCHAR(50) | ✅ 一致 |
| receiverZipCode | varchar(20) | VARCHAR(1000) | 🔄 需调整 |
| logicNumber | varchar(100) | VARCHAR(100) | ✅ 一致 |
| orderType | int(11) | INT(11) | ✅ 一致 |
| CVSStoreID | varchar(50) | VARCHAR(50) | ✅ 一致 |
| CVSStoreName | varchar(100) | VARCHAR(100) | ✅ 一致 |
| CVSAddress | varchar(255) | VARCHAR(255) | ✅ 一致 |
| CVSTelephone | varchar(50) | VARCHAR(50) | ✅ 一致 |
| CVSOutSide | int(11) | INT(11) | ✅ 一致 |

## 执行步骤

1. **运行数据库脚本**：
   ```sql
   -- 执行 add_missing_order_fields.sql 脚本
   source add_missing_order_fields.sql;
   ```

2. **验证更改**：
   - 检查数据库表结构是否与建表语句一致
   - 测试应用程序功能是否正常
   - 验证物流信息更新功能

## 注意事项

1. **向后兼容性**：保留了原有的 `updateLogisticsInfo` 方法，确保现有代码不会受到影响
2. **字段长度调整**：某些字段的长度从 VARCHAR(1000) 调整为更合适的长度
3. **索引维护**：确保 userId 字段的索引存在
4. **测试建议**：在生产环境执行前，建议在测试环境先验证所有功能

## 相关文件

- `src/main/java/cc/carce/sale/entity/CarOrderInfoEntity.java`
- `src/main/java/cc/carce/sale/mapper/manager/CarOrderInfoMapper.java`
- `src/main/resources/mapper/manager/CarOrderInfoMapper.xml`
- `src/main/java/cc/carce/sale/service/CarOrderInfoService.java`
- `add_missing_order_fields.sql`
